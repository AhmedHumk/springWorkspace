# ==========================
# ููู Docker Compose
# ==========================
# ุงูููู ุฏู ุจูุฌูุน ูู ุงูุฎุฏูุงุช ุงููู ูุดุฑูุนู ูุญุชุงุฌูุง
# (ูุงุนุฏุฉ ุจูุงูุงุชุ ูุงุฌูุงุช ุฅุฏุงุฑุฉุ Redis)
# ูู ุฎุฏูุฉ ุจุชุดุชุบู ูู Container 
# ูููุตู ููู ูุชูุตูุฉ ุจุจุนุถ ุฏุงุฎูููุง
# ุงูุบุฑุถ ุฅูู ุชูุฏุฑ ุชุณุชุฎุฏู ุงูุฎุฏูุงุช ุฏู ูู ูุดุฑูุน ุฒู
# Spring Boot SaaS (Software as a Service)
# ==============================================
# ุจุฏุงูุฉ ุชุนุฑูู ุงูุฎุฏูุงุช ุงููู ุงููุดุฑูุน ููุณุชุฎุฏููุง
# ุจุงููุณุจุฉ ูู 
# pgAdmin:
# ูุชูุณุงุด ุชุณุฌู ุงูุณูุฑูุฑ ุจุนุฏ ูุง ุชุซุจุชู
# ุนู ุทุฑูู ุฒูุงุฑุฉ 
# pgAdmin http://localhost:<AdminPort>
# ูุชุญุท 
# postgres
# ูู ุฎุงูุฉ 
# host 
# ุฃุซูุงุก ุงูุชุณุฌูู.
# Clean your docker if needed warning this will delete everything!
# powerShell / terminal
# docker system prune -a --volumes
# Run it using
# docker-compose up -d
services:
  # ==========================
  #  MySQL Database
  # ==========================
  mysql:
    image: mysql:8.4                # mysql Version
    container_name: mysql_db        # ุงุณู ุงูุญุงููุฉ ุฏุงุฎู Docker (ูุชุธูุฑ ูุฏู ูู docker ps)
    restart: always                 # ูุนูุฏ ุงูุชุดุบูู ุชููุงุฆููุง ูู ุญุตู ุชููู ููุงุฌุฆ
    env_file:
      - .env                        # ุชุญููู ุงููุชุบูุฑุงุช ูู ููู .env (ูููุฉ ุงูุณุฑุ ุงุณู ุงููุณุชุฎุฏู..)
    environment:                    # ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููู MySQL ุจูุญุชุงุฌูุง
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}   # ุจุงุณูุฑุฏ ุงููุณุชุฎุฏู ุงูุฑุฆูุณู
      MYSQL_DATABASE: ${MYSQL_DATABASE}             # ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ
      MYSQL_USER: ${MYSQL_USER}                     # ุงุณู ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ
      MYSQL_PASSWORD: ${MYSQL_PASSWORD}             # ุงูุจุงุณูุฑุฏ ุงูุฎุงุต ุจุงููุณุชุฎุฏู ุงูุฌุฏูุฏ
    ports:
      - "${MYSQL_PORT}:3306"        # ุจูุฑุจุท ุงููููุฐ 3306 ุฏุงุฎู ุงูุญุงููุฉ ุจุงููููุฐ ุงููู ุชุฎุชุงุฑู ูู .env
    volumes:
      - mysql_data:/var/lib/mysql   # ุจูุฎุฒู ุจูุงูุงุช MySQL ูู ูุฌูุฏ ุฏุงุฆู ุญุชู ุจุนุฏ ุฅููุงู ุงูุญุงููุฉ

  # ==========================
  #  phpMyAdmin (ูุงุฌูุฉ ุฅุฏุงุฑุฉ MySQL)
  # ==========================
  phpmyadmin:
    image: phpmyadmin:latest        # get latest version
    container_name: phpmyadmin      # ุงุณู ุงูุญุงููุฉ ุฏุงุฎู Docker
    restart: always                 # ูุนูุฏ ุงูุชุดุบูู ุชููุงุฆููุง ุนูุฏ ุงูุชููู
    depends_on:
      - mysql                       # phpMyAdmin ูุด ููุจุฏุฃ ุฅูุง ุจุนุฏ ุชุดุบูู MySQL
    env_file:
      - .env                        # ุจูุงุฎุฏ ุงูููู ูู ููู .env
    environment:                    # ุฅุนุฏุงุฏุงุช ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
      PMA_HOST: mysql               # ุงุณู ุฎุฏูุฉ MySQL ุงููู ููู (ุนุดุงู ูุชุตู ุจููุง ุฏุงุฎูููุง)
      PMA_USER: ${MYSQL_USER}       # ุงุณู ุงููุณุชุฎุฏู ุงููู ููุณุฌู ุงูุฏุฎูู ุจูู
      PMA_PASSWORD: ${MYSQL_PASSWORD} # ุงูุจุงุณูุฑุฏ ูููุณุชุฎุฏู
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}   # ุจุงุณูุฑุฏ ุงููุณุชุฎุฏู ุงูุฌุฐุฑ
    ports:
      - "${PHPMYADMIN_PORT}:80"     # ุชุดุบูู phpMyAdmin ุนูู ุงููููุฐ ุงููู ุชุฎุชุงุฑู ูู .env (ูุซูุงู 8081)

  # ==========================
  #  PostgreSQL Database
  # ==========================
  postgres:
    image: postgres:16              # postgresql version
    container_name: postgres_db     # ุงุณู ุงูุญุงููุฉ
    restart: always                 # ุฅุนุงุฏุฉ ุงูุชุดุบูู ุงูุชููุงุฆู ุนูุฏ ุงูุชููู
    env_file:
      - .env                        # ุชุญููู ุงููุชุบูุฑุงุช ูู ููู .env
    environment:                    # ุฅุนุฏุงุฏุงุช PostgreSQL
      POSTGRES_USER: ${POSTGRES_USER}         # ุงุณู ุงููุณุชุฎุฏู
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD} # ุงูุจุงุณูุฑุฏ
      POSTGRES_DB: ${POSTGRES_DB}             # ุงุณู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ
    ports:
      - "${POSTGRES_PORT}:5432"     # ุฑุจุท ุงููููุฐ 5432 ุงูุฏุงุฎูู ุจุงูุฎุงุฑุฌู ุงููู ุชุญุฏุฏู ูู .env
    volumes:
      - postgres_data:/var/lib/postgresql/data  # ุญูุธ ุจูุงูุงุช PostgreSQL ุนูู ุฌูุงุฒู

  # ==========================
  #  pgAdmin (ูุงุฌูุฉ PostgreSQL)
  # ==========================
  pgadmin:
    image: dpage/pgadmin4:latest    # Get latest version
    container_name: pgadmin         # ุงุณู ุงูุญุงููุฉ ุฏุงุฎู Docker
    restart: always                 # ุฅุนุงุฏุฉ ุงูุชุดุบูู ุงูุชููุงุฆู
    depends_on:
      - postgres                    # ูุง ูุดุชุบูุด ุฅูุง ุจุนุฏ ุชุดุบูู PostgreSQL
    env_file:
      - .env                        # ุชุญููู ุงููุชุบูุฑุงุช ูู .env
    environment:                    # ุฅุนุฏุงุฏุงุช ุชุณุฌูู ุงูุฏุฎูู ูู pgAdmin
      PGADMIN_DEFAULT_EMAIL: ${PGADMIN_DEFAULT_EMAIL}       # ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุชุณุฌูู ุงูุฏุฎูู
      PGADMIN_DEFAULT_PASSWORD: ${PGADMIN_DEFAULT_PASSWORD} # ูููุฉ ุงููุฑูุฑ ูุชุณุฌูู ุงูุฏุฎูู
    ports:
      - "${PGADMIN_PORT}:80"        # ุงููููุฐ ุงูุฎุงุฑุฌู ุงููู pgAdmin ููุดุชุบู ุนููู (ูู .env)

  # ==========================
  #  Redis Cache Server
  # ==========================
  redis:
    image: redis:7                  # redis version
    container_name: redis_cache     # ุงุณู ุงูุญุงููุฉ ุฏุงุฎู Docker
    restart: always                 # ุฅุนุงุฏุฉ ุงูุชุดุบูู ุงูุชููุงุฆู ุนูุฏ ุงูุชููู
    env_file:
      - .env                        # ุชุญููู ุงูุฅุนุฏุงุฏุงุช ูู ููู .env
    ports:
      - "${REDIS_PORT}:6379"        # ุงููููุฐ ุงูุฎุงุฑุฌู ุงููู Redis ููุชุงุญ ุนููู
    volumes:
      - redis_data:/data            # ุญูุธ ุงูุจูุงูุงุช ุงููุคูุชุฉ ูู Redis ุนูู ุฌูุงุฒู

# ==========================
# ๐ฆ ุชุนุฑูู Volumes
# ==========================
volumes:
  mysql_data:                       # ููุงู ุชุฎุฒูู ุจูุงูุงุช MySQL
  postgres_data:                    # ููุงู ุชุฎุฒูู ุจูุงูุงุช PostgreSQL
  redis_data:                       # ููุงู ุชุฎุฒูู ุจูุงูุงุช Redis